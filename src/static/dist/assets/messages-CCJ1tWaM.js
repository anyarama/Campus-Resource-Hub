class a{constructor(){this.thread=document.querySelector("[data-thread]"),this.form=document.querySelector("[data-composer]"),this.textarea=this.form?this.form.querySelector("[data-composer-input]"):null,this.conversationLinks=document.querySelectorAll("[data-conversation-link]"),this.init()}init(){this.thread&&this.scrollThreadToBottom(),this.bindComposer(),this.bindConversationLinks()}scrollThreadToBottom(){requestAnimationFrame(()=>{this.thread.scrollTop=this.thread.scrollHeight})}bindComposer(){if(!this.form)return;if(this.form.addEventListener("keydown",t=>{(t.metaKey||t.ctrlKey)&&t.key==="Enter"&&(t.preventDefault(),this.form.requestSubmit())}),this.textarea){const t=()=>{this.textarea.style.height="auto",this.textarea.style.height=`${Math.min(this.textarea.scrollHeight,220)}px`};this.textarea.addEventListener("input",t),t(),this.textarea.focus()}const i=this.form.querySelector("[data-attach-trigger]"),e=this.form.querySelector("[data-attach-input]");i&&e&&(i.addEventListener("click",()=>e.click()),e.addEventListener("change",()=>{if(!e.files.length)return;const t=e.files[0].name,r=document.querySelector(".composer-hint");r&&(r.textContent=`${t} attached (not sent)`)}))}bindConversationLinks(){this.conversationLinks.forEach(i=>{i.addEventListener("click",()=>{i.classList.remove("is-unread");const e=i.querySelector("[data-unread-badge]");e&&e.remove()})})}}window.addEventListener("DOMContentLoaded",()=>{new a});
