class r{constructor(e){this.container=e,this.slides=e.querySelectorAll(".carousel__slide"),this.thumbnails=e.querySelectorAll(".carousel__thumb"),this.prevBtn=e.querySelector("[data-carousel-prev]"),this.nextBtn=e.querySelector("[data-carousel-next]"),this.counter=e.querySelector("[data-carousel-counter]"),this.fullscreenBtn=e.querySelector("[data-carousel-fullscreen]"),this.currentIndex=0,this.isAnimating=!1,this.touchStartX=0,this.touchEndX=0,this.isFullscreen=!1,this.slides.length>0&&this.init()}init(){this.showSlide(0),this.updateCounter(),this.updateButtons(),this.setupNavigation(),this.setupThumbnails(),this.setupKeyboard(),this.setupTouch(),this.setupFullscreen(),this.lazyLoadImages()}setupNavigation(){this.prevBtn&&this.prevBtn.addEventListener("click",()=>this.prev()),this.nextBtn&&this.nextBtn.addEventListener("click",()=>this.next())}next(){if(this.isAnimating||this.slides.length<=1)return;const e=(this.currentIndex+1)%this.slides.length;this.goToSlide(e)}prev(){if(this.isAnimating||this.slides.length<=1)return;const e=(this.currentIndex-1+this.slides.length)%this.slides.length;this.goToSlide(e)}goToSlide(e){e===this.currentIndex||this.isAnimating||(this.isAnimating=!0,this.slides[this.currentIndex].classList.remove("is-active"),this.slides[this.currentIndex].setAttribute("aria-hidden","true"),this.currentIndex=e,this.slides[this.currentIndex].classList.add("is-active"),this.slides[this.currentIndex].setAttribute("aria-hidden","false"),this.updateThumbnails(),this.updateCounter(),this.updateButtons(),this.lazyLoadAdjacentImages(),setTimeout(()=>{this.isAnimating=!1},300))}showSlide(e){this.slides.forEach((t,s)=>{s===e?(t.classList.add("is-active"),t.setAttribute("aria-hidden","false")):(t.classList.remove("is-active"),t.setAttribute("aria-hidden","true"))}),this.currentIndex=e,this.updateThumbnails(),this.updateCounter()}setupThumbnails(){this.thumbnails.forEach((e,t)=>{e.addEventListener("click",()=>{this.goToSlide(t)}),e.addEventListener("keydown",s=>{(s.key==="Enter"||s.key===" ")&&(s.preventDefault(),this.goToSlide(t))}),e.setAttribute("role","button"),e.setAttribute("tabindex","0"),e.setAttribute("aria-label",`View image ${t+1}`)})}updateThumbnails(){this.thumbnails.forEach((e,t)=>{t===this.currentIndex?(e.classList.add("is-active"),e.setAttribute("aria-current","true")):(e.classList.remove("is-active"),e.removeAttribute("aria-current"))})}setupKeyboard(){document.addEventListener("keydown",e=>{if(this.container.contains(document.activeElement))switch(e.key){case"ArrowLeft":e.preventDefault(),this.prev();break;case"ArrowRight":e.preventDefault(),this.next();break;case"Home":e.preventDefault(),this.goToSlide(0);break;case"End":e.preventDefault(),this.goToSlide(this.slides.length-1);break;case"Escape":this.isFullscreen&&(e.preventDefault(),this.exitFullscreen());break}})}setupTouch(){const e=this.container.querySelector(".carousel__track");e&&(e.addEventListener("touchstart",t=>{this.touchStartX=t.changedTouches[0].screenX},{passive:!0}),e.addEventListener("touchend",t=>{this.touchEndX=t.changedTouches[0].screenX,this.handleSwipe()},{passive:!0}))}handleSwipe(){const t=this.touchStartX-this.touchEndX;Math.abs(t)>50&&(t>0?this.next():this.prev())}updateCounter(){this.counter&&(this.counter.textContent=`${this.currentIndex+1} / ${this.slides.length}`)}updateButtons(){this.slides.length<=1?(this.prevBtn&&(this.prevBtn.style.display="none"),this.nextBtn&&(this.nextBtn.style.display="none")):(this.prevBtn&&(this.prevBtn.style.display=""),this.nextBtn&&(this.nextBtn.style.display=""))}lazyLoadImages(){this.slides[0]&&this.loadSlideImage(0),this.lazyLoadAdjacentImages()}lazyLoadAdjacentImages(){const e=(this.currentIndex+1)%this.slides.length,t=(this.currentIndex-1+this.slides.length)%this.slides.length;this.loadSlideImage(e),this.loadSlideImage(t)}loadSlideImage(e){const t=this.slides[e];if(!t)return;const s=t.querySelector("img[data-src]");s&&(s.src=s.dataset.src,s.removeAttribute("data-src"),s.addEventListener("load",()=>{s.classList.add("is-loaded")}))}setupFullscreen(){this.fullscreenBtn&&(this.fullscreenBtn.addEventListener("click",()=>{this.isFullscreen?this.exitFullscreen():this.enterFullscreen()}),document.addEventListener("fullscreenchange",()=>{document.fullscreenElement||(this.isFullscreen=!1,this.container.classList.remove("is-fullscreen"))}))}enterFullscreen(){this.container.requestFullscreen?(this.container.requestFullscreen(),this.isFullscreen=!0,this.container.classList.add("is-fullscreen")):this.container.webkitRequestFullscreen&&(this.container.webkitRequestFullscreen(),this.isFullscreen=!0,this.container.classList.add("is-fullscreen"))}exitFullscreen(){document.exitFullscreen?document.exitFullscreen():document.webkitExitFullscreen&&document.webkitExitFullscreen(),this.isFullscreen=!1,this.container.classList.remove("is-fullscreen")}destroy(){var e,t;(e=this.prevBtn)==null||e.removeEventListener("click",this.prev),(t=this.nextBtn)==null||t.removeEventListener("click",this.next)}}function n(){const i=document.querySelectorAll("[data-carousel]"),e=[];return i.forEach(t=>{e.push(new r(t))}),e}document.readyState==="loading"?document.addEventListener("DOMContentLoaded",n):n();
