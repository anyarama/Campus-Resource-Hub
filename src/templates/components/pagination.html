{#
Pagination Component
Usage:
  {% from "components/pagination.html" import pagination %}
  {{ pagination(current_page=2, total_pages=10, url_pattern='/resources?page={}') }}

Parameters:
  - current_page: Current page number (required)
  - total_pages: Total number of pages (required)
  - url_pattern: URL pattern with {} placeholder for page number (required)
  - max_links: Maximum number of page links to show (default: 5)
  - class: Additional CSS classes (optional)
#}

{% macro pagination(current_page, total_pages, url_pattern, max_links=5, class='') %}
  {% if total_pages > 1 %}
    <nav aria-label="Pagination" class="pagination {{ class }}">
      <ul class="pagination__list">
        {# Previous button #}
        <li class="pagination__item">
          {% if current_page > 1 %}
            <a href="{{ url_pattern.format(current_page - 1) }}" 
               class="pagination__link pagination__link--prev" 
               aria-label="Previous page">
              <i class="fas fa-chevron-left" aria-hidden="true"></i>
              <span class="pagination__text">Previous</span>
            </a>
          {% else %}
            <span class="pagination__link pagination__link--prev pagination__link--disabled" 
                  aria-disabled="true">
              <i class="fas fa-chevron-left" aria-hidden="true"></i>
              <span class="pagination__text">Previous</span>
            </span>
          {% endif %}
        </li>

        {# Page numbers #}
        {% set start_page = [1, current_page - (max_links // 2)]|max %}
        {% set end_page = [total_pages, start_page + max_links - 1]|min %}
        {% set start_page = [1, end_page - max_links + 1]|max %}

        {% if start_page > 1 %}
          <li class="pagination__item">
            <a href="{{ url_pattern.format(1) }}" class="pagination__link">1</a>
          </li>
          {% if start_page > 2 %}
            <li class="pagination__item">
              <span class="pagination__ellipsis">…</span>
            </li>
          {% endif %}
        {% endif %}

        {% for page in range(start_page, end_page + 1) %}
          <li class="pagination__item">
            {% if page == current_page %}
              <span class="pagination__link pagination__link--current" aria-current="page">{{ page }}</span>
            {% else %}
              <a href="{{ url_pattern.format(page) }}" class="pagination__link">{{ page }}</a>
            {% endif %}
          </li>
        {% endfor %}

        {% if end_page < total_pages %}
          {% if end_page < total_pages - 1 %}
            <li class="pagination__item">
              <span class="pagination__ellipsis">…</span>
            </li>
          {% endif %}
          <li class="pagination__item">
            <a href="{{ url_pattern.format(total_pages) }}" class="pagination__link">{{ total_pages }}</a>
          </li>
        {% endif %}

        {# Next button #}
        <li class="pagination__item">
          {% if current_page < total_pages %}
            <a href="{{ url_pattern.format(current_page + 1) }}" 
               class="pagination__link pagination__link--next" 
               aria-label="Next page">
              <span class="pagination__text">Next</span>
              <i class="fas fa-chevron-right" aria-hidden="true"></i>
            </a>
          {% else %}
            <span class="pagination__link pagination__link--next pagination__link--disabled" 
                  aria-disabled="true">
              <span class="pagination__text">Next</span>
              <i class="fas fa-chevron-right" aria-hidden="true"></i>
            </span>
          {% endif %}
        </li>
      </ul>
    </nav>
  {% endif %}
{% endmacro %}
