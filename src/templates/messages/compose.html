{% extends "base.html" %}

{% block title %}Message {{ recipient.name }}{% endblock %}

{% block main_content %}
<section class="messages-detail">
  <article class="ui-card messages-thread__panel">
    <header class="messages-thread__header">
      <div class="messages-thread__user">
        <div class="messages-thread__user-avatar">
          {% if recipient.profile_image %}
            <img src="{{ url_for('static', filename='uploads/' + recipient.profile_image) }}" alt="{{ recipient.name }}">
          {% else %}
            {{ recipient.name[0]|upper }}
          {% endif %}
        </div>
        <div class="messages-thread__user-meta">
          <p class="resources-dashboard__eyebrow">New message to</p>
          <h2>{{ recipient.name }}</h2>
          <p>{{ recipient.email }}</p>
        </div>
      </div>
      <a href="{{ url_for('messages.inbox', user_id=recipient.user_id) }}" class="ui-button ui-button--ghost">
        <i data-lucide="x" class="icon icon-sm"></i>
        Cancel
      </a>
    </header>

    <form method="POST" action="{{ url_for('messages.compose', user_id=recipient.user_id) }}" class="messages-thread__composer">
      <input type="hidden" name="csrf_token" value="{{ csrf_token() }}">
      <label class="ui-field">
        <span class="ui-field__label">Message</span>
        <textarea
          id="content"
          name="content"
          rows="6"
          maxlength="10000"
          placeholder="Introduce yourself, include booking context, or ask your question."
          required
          class="ui-input messages-thread__input"></textarea>
      </label>
      <div class="messages-thread__composer-actions">
        <div>
          <p class="composer-hint">
            <i data-lucide="info" class="icon icon-xs"></i>
            Keep it professional. Messages are plain text only.
          </p>
          <ul class="list--unstyled composer-guidelines">
            <li>• Be clear about the resource or booking you’re referencing.</li>
            <li>• Share any availability constraints or preferred times.</li>
            <li>• Avoid sharing sensitive data; chats are archived.</li>
          </ul>
        </div>
        <button type="submit" class="ui-button ui-button--primary">
          <i data-lucide="send" class="icon icon-sm"></i>
          Send message
        </button>
      </div>
    </form>
  </article>

  <article class="ui-card messages-thread__panel">
    <div class="messages-empty">
      <i data-lucide="lightbulb" class="icon icon-lg"></i>
      <h3>Need help getting started?</h3>
      <p>Use messaging to clarify booking requests, coordinate logistics, or follow up on reviews.</p>
    </div>
  </article>
</section>
{% endblock %}
