{% extends"base.html" %}{% from"reviews/_star_rating.html" import render_rating_summary %}{% from"reviews/_review_form.html" import render_review_form %}{% from"reviews/_review_list.html" import render_review_list %}{% block title %}{{ resource.title }}- Campus Resource Hub{% endblock %}{% block content %}<nav aria-label="breadcrumb" class="space-b-4">
    <ol class="breadcrumb">
      <li class="breadcrumb-item"></li></ol></nav>{{ url_for('resources.index') }}">Resources
      <li aria-current="page" class="breadcrumb-item active"></li>{{ resource.title }}<div class="layout-grid">
    <!-- Left Column: Images & Main Info -->
    <div class="layout-col" data-col-lg="8">
      <!-- Image Gallery -->
      </div></div>{% if images and images|length > 0 %}<div class="carousel slide" data-bs-ride="carousel" id="resourceCarousel">
        <div class="carousel-indicators">
          </div></div>{% for img in images %}{{ loop.index0 }}" 
              {% if loop.first %}class="active" aria-current="true"{% endif %}aria-label="Slide {{ loop.index }}">
          {% endfor %}<div class="carousel-inner rounded">
          </div>{% for img in images %}{% if loop.first %}active{% endif %}">
            {{ url_for('static', filename='uploads/' + img) }}" 
               class="d-block" 
               alt="{{ resource.title }}- Image {{ loop.index }}"
               style="max-height: 500px; object-fit: cover;">
          
          {% endfor %}{% if images|length > 1 %}<button class="carousel-control-prev" data-bs-slide="prev" data-bs-target="#resourceCarousel" type="button">
          <span aria-hidden="true" class="carousel-control-prev-icon"></span>
          <span class="visually-hidden">Previous</span>
        </button>
        <button class="carousel-control-next" data-bs-slide="next" data-bs-target="#resourceCarousel" type="button">
          <span aria-hidden="true" class="carousel-control-next-icon"></span>
          <span class="visually-hidden">Next</span>
        </button>
        {% endif %}{% else %}<div class="card">
        <div class="card-body" style="min-height: 300px; display: flex; align-items: center; justify-content: center;">
          <div>
            <i class="bi bi-image" style="font-size: 4rem; color: #ccc;"></i>
            <p class="text-dim">No images available</p>
          </div>
        </div>
      </div>
      {% endif %}<div class="card">
        <div class="card-header">
          <h2 class="h4"></h2></div></div>{{ resource.title }}<div class="space-t-2">
            <span class="badge badge-primary"></span></div>{{ resource.category or 'Uncategorized' }}{% if resource.status == 'draft' %}<span class="badge badge-secondary">Draft</span>
            {% elif resource.status == 'published' %}<span class="badge badge-success">Published</span>
            {% elif resource.status == 'archived' %}<span class="badge badge-warning">Archived</span>
            {% endif %}<div class="card-body">
          <!-- Description -->
          <h5 class="card-title">Description</h5>
          <p class="card-text"></p></div>{{ resource.description or 'No description provided.' }}<div class="layout-grid">
            <div class="layout-col" data-col="12">
              <p class="space-b-1"><strong><i class="bi bi-geo-alt"></i> Location:</strong></p>
              <p class="text-dim"></p></div></div>{{ resource.location or 'Not specified' }}<div class="layout-col" data-col="12">
              <p class="space-b-1"><strong><i class="bi bi-people"></i> Capacity:</strong></p>
              <p class="text-dim"></p></div>{{ resource.capacity or 'Not specified' }}<div class="layout-col" data-col="12">
              <p class="space-b-1"><strong><i class="bi bi-calendar-event"></i> Created:</strong></p>
              <p class="text-dim"></p></div>{{ resource.created_at.strftime('%B %d, %Y') if resource.created_at else 'Unknown' }}<div class="layout-col" data-col="12">
              <p class="space-b-1"><strong><i class="bi bi-person"></i> Owner:</strong></p>
              <p class="text-dim"></p></div>{{ resource.owner.name if resource.owner else 'Unknown' }}{% if availability %}<div class="space-t-4">
            <h5 class="card-title">Availability</h5>
            <div class="alert alert-info">
              <i class="bi bi-clock"></i> </div></div>{{ availability.get('description', 'Check with owner for availability') }}{% endif %}{% if current_user.is_authenticated and can_review %}{{ render_review_form(resource, user_review, is_edit=(user_review is not none)) }}{% endif %}{% if reviews %}{{ render_review_list(reviews, resource, current_user, show_moderation=(current_user.role == 'admin' if current_user.is_authenticated else False)) }}{% else %}<div class="card" id="reviews">
          <div class="card-header">
            <h5 class="space-b-0">
              <i class="bi bi-chat-left-quote"></i>Reviews
            </h5>
          </div>
          <div class="card-body">
            <i class="bi bi-chat-left-quote" style="font-size: 4rem;"></i>
            <h5 class="space-t-3">No Reviews Yet</h5>
            <p class="text-dim">Be the first to review this resource!</p>
            </div></div>{% if current_user.is_authenticated and can_review %}<a class="btn btn-primary" href="#review-form">
                <i class="bi bi-star"></i>Write a Review
              </a>
            {% endif %}{% endif %}<div class="layout-col" data-col-lg="4">
      <!-- Action Buttons Card -->
      <div class="card sticky-top" style="top: 20px;">
        <div class="card-body">
          </div></div></div>{% if current_user.is_authenticated %}{% if resource.owner_id == current_user.user_id %}<h5 class="card-title">Manage Resource</h5>
            
            {{ url_for('resources.edit', resource_id=resource.resource_id) }}" 
              class="btn btn-primary">
              <i class="bi bi-pencil"></i> Edit Resource
            

            {% if resource.status == 'draft' %}{{ url_for('resources.publish', resource_id=resource.resource_id) }}" class="mb-2">
              {{ csrf_token() }}">
              <button class="btn btn-success" type="submit">
                <i class="bi bi-check-circle"></i> Publish Resource
              </button>
            
            {% elif resource.status == 'published' %}{{ url_for('resources.archive', resource_id=resource.resource_id) }}" class="mb-2">
              {{ csrf_token() }}">
              <button class="btn btn-warning" type="submit">
                <i class="bi bi-archive"></i> Archive Resource
              </button>
            
            {% endif %}<hr/>

            {{ url_for('resources.delete', resource_id=resource.resource_id) }}" 
               onsubmit="return confirm('Are you sure you want to delete this resource? This action cannot be undone.');"
               class="mb-0">
              {{ csrf_token() }}">
              <button class="btn btn-danger" type="submit">
                <i class="bi bi-trash"></i> Delete Resource
              </button>
            

            {% else %}<h5 class="card-title">Book This Resource</h5>
            
            {% if resource.status == 'published' %}{{ url_for('bookings.new', resource_id=resource.resource_id) }}" 
              class="btn btn-success">
              <i class="bi bi-calendar-check"></i> Request Booking
            
            <p class="text-dim small">
              <i class="bi bi-clock"></i> Choose your preferred date and time
            </p>
            {% else %}<div class="alert alert-warning">
              <i class="bi bi-exclamation-triangle"></i> This resource is not available for booking.
            </div>
            {% endif %}<hr/>

            {{ url_for('messages.about_resource', resource_id=resource.resource_id) }}" 
              class="btn btn-outline">
              <i class="bi bi-chat-dots"></i> Message Owner
            
            <p class="text-dim small">
              <i class="bi bi-info-circle"></i> Ask questions about this resource
            </p>
            {% endif %}{% else %}<h5 class="card-title">Book This Resource</h5>
          <div class="alert alert-info">
            <i class="bi bi-info-circle"></i> Please </div>{{ url_for('auth.login') }}">log in to book this resource.
          
          {% endif %}<div class="card">
        <div class="card-header">
          <h6 class="space-b-0">Quick Info</h6>
        </div>
        <div class="card-body">
          <div class="flex">
            <span><i class="bi bi-calendar-check"></i> Bookings:</span>
            <span class="badge badge-info"></span></div></div></div>{{ booking_count }}total
          
          <div class="flex">
            <span><i class="bi bi-star"></i> Reviews:</span>
            </div>{% if resource.average_rating %}<div>
                </div>{{ render_rating_summary(resource.average_rating, reviews|length, size='sm') }}{% else %}<span class="badge badge-secondary">No reviews yet</span>
            {% endif %}<div class="card">
        <div class="card-body">
          <h6 class="card-title">Share This Resource</h6>
          <div class="d-grid gap-2">
            <button class="btn btn-ghost" disabled="">
              <i class="bi bi-link-45deg"></i> Copy Link
            </button>
            <button class="btn btn-ghost" disabled="">
              <i class="bi bi-envelope"></i> Email
            </button>
          </div>
        </div>
      </div>
    
  


<style>
  /* Custom styles for detail page */
  .carousel-item img {
    border-radius: 0.5rem;
  }
  
  .sticky-top {
    z-index: 1020;
  }

  /* Smooth transitions for action buttons */
  .btn {
    transition: all 0.3s ease;
  }

  /* Badge styling */
  .badge {
    font-size: 0.85rem;
    padding: 0.4em 0.6em;
  }

  /* Card shadow on hover */
  .card {
    transition: box-shadow 0.3s ease;
  }

  .card:hover {
    box-shadow: 0 4px 12px rgba(0,0,0,0.1);
  }
</style>
{% endblock %}